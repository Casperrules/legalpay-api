[build]
builder = "NIXPACKS"
buildCommand = "chmod +x mvnw && ./mvnw clean install -DskipTests -Dmaven.compiler.useIncrementalCompilation=false && cp legalpay-api/target/legalpay-api-1.0.0-SNAPSHOT.jar app.jar"

[deploy]
startCommand = "java -Xmx512m -Xms256m -jar app.jar"
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10

[env]
SPRING_PROFILES_ACTIVE = "prod"
PORT = "8080"
MAVEN_OPTS = "-Xmx1024m -Xms512m -XX:+UseG1GC"
